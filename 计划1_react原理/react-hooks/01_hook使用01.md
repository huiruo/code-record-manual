#### 01.简单的使用

```js
import React, { useState } from "react";

export default function Button() {
  const [buttonText, setButtonText] = useState("Click me, please");

  function handleButtonClick() {
    return setButtonText("Thanks, been clicked!");
  }

  return <button onClick={handleButtonClick}>{buttonText}</button>;
}
```

#### 02.React Hooks 获取数据

02-1.在这之前， 我们都是在 `componentDidMount` 函数里调API：

```js
import React, { Component } from "react";

export default class DataLoader extends Component {
  
state = { data: [] };

  async componentDidMount() {
    try {
      const response = await fetch(`https://api.coinmarketcap.com/v1/ticker/?limit=10`);
      if (!response.ok) {
        throw Error(response.statusText);
      }
      const json = await response.json();
      this.setState({ data: json });
    } catch (error) {
      console.log(error);
    }
  }

  render() {
    return (
      <div>
        <ul>
          {this.state.data.map(el => (
            <li key={el.id}>{el.name}</li>
          ))}
        </ul>
      </div>
    );
  }
}
```

2.02.用 Hooks 来重写：注意报错了， 无限循环：

```js

import React, { useState, useEffect } from "react";

export default function DataLoader() {
  const [data, setData] = useState([]);

  useEffect(() => {
    fetch("http://localhost:3001/links/")
      .then(response => response.json())
      .then(data => setData(data));
  });

  return (
    <div>
      <ul>
        {data.map(el => (
          <li key={el.id}>{el.title}</li>
        ))}
      </ul>
    </div>
  );
}
```

> 原因其实也非常简单，`useEffect` 存在的目的 和`componentDidMount, componentDidUpdate, and componentWillUnmount`是一致的， 每次state 变化 或者 有新的props 进来的时候，componentDidUpdate componentDidUpdate` 都会执行。
>
> 要解决这个 "bug" 也非常简单, 给 useEffect 传入一个空数组作为第二个参数:
>
> 
>
> ```js
> useEffect(() => {
>     fetch("http://localhost:3001/links/")
>       .then(response => response.json())
>       .then(data => setData(data));
>   },[]); // << super important array
> ```

#### 3.能把 Hooks 用于 Render props 吗

能显然是能的， 不过没什么意义， 比如把上面的代码改一下：

```
import React, { useState, useEffect } from "react";

export default function DataLoader(props) {
  const [data, setData] = useState([]);

  useEffect(() => {
    fetch("http://localhost:3001/links/")
      .then(response => response.json())
      .then(data => setData(data));
  }, []); 

  return props.render(data)
}
```

从外部传入一个render即可， 但是这样做毫无意义： `Reack Hooks 本身就是为了解决组件间逻辑公用的问题的。`

#### 4.定义你的 React Hook

还是上面的例子，我们把取数据的逻辑抽出来：

```js
// useFetch.tsx
import { useState, useEffect } from "react";

export default function useFetch(url) {
  const [data, setData] = useState([]);

  useEffect(() => {
    fetch(url)
      .then(response => response.json())
      .then(data => setData(data));
  }, [] );

  return data;
}
```

在其他组件中引用：

```js
import React from "react";
import useFetch from "./useFetch";

export default function DataLoader(props) {
  const data = useFetch("http://localhost:3001/links/");
  return (
    <div>
      <ul>
        {data.map(el => (
          <li key={el.id}>{el.title}</li>
        ))}
      </ul>
    </div>
  );
}
```



#### 5.React Hooks 的本质

上面我们说到 `Reack Hooks 本身就是为了解决组件间逻辑公用的问题的。`

回顾我们以前的做法，几乎都是面向生命周期编程：

最新的React 中， 预置了大量的Hooks， 最重要两个的就是： `useState` and `useEffect`.

useState 使我们在`不借助 ES6 class 的前提下， 在组件内部使用 state 成为可能`。

useEffect 取代了 `componentDidMount, componentDidUpdate, and componentWillUnmount`, 提供了一个`统一的API`。

官方文档：

https://reactjs.org/docs/hooks-reference.html

中文：

https://zh-hans.reactjs.org/docs/hooks-reference.html#___gatsby

> - [Basic Hooks](https://reactjs.org/docs/hooks-reference.html#basic-hooks)
>   - [`useState`](https://reactjs.org/docs/hooks-reference.html#usestate)
>   - [`useEffect`](https://reactjs.org/docs/hooks-reference.html#useeffect)
>   - [`useContext`](https://reactjs.org/docs/hooks-reference.html#usecontext)
> - [Additional Hooks](https://reactjs.org/docs/hooks-reference.html#additional-hooks)
>   - [`useReducer`](https://reactjs.org/docs/hooks-reference.html#usereducer)
>   - [`useCallback`](https://reactjs.org/docs/hooks-reference.html#usecallback)
>   - [`useMemo`](https://reactjs.org/docs/hooks-reference.html#usememo)
>   - [`useRef`](https://reactjs.org/docs/hooks-reference.html#useref)
>   - [`useImperativeHandle`](https://reactjs.org/docs/hooks-reference.html#useimperativehandle)
>   - [`useLayoutEffect`](https://reactjs.org/docs/hooks-reference.html#uselayouteffect)
>   - [`useDebugValue`](https://reactjs.org/docs/hooks-reference.html#usedebugvalue)

